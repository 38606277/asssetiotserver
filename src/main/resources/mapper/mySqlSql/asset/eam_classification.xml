<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="eam_classification">

    <insert id="add"  parameterType="Map">
        insert into eam_classification(code, parent_code,name,life,unit,path,level) values(#{code}, #{parent_code}, #{name}, #{life}, #{unit},#{path},#{level})
    </insert>

    <delete id="deleteByCode" parameterType="Map">
        delete from eam_classification where code = #{code} or path like "${path}${code}-%"
    </delete>

    <update id="updateByCode" parameterType="Map">
        update eam_classification
        <trim prefix="set" suffixOverrides=",">
            <if test="parent_code!=null">parent_code=#{parent_code},</if>
            <if test="name!=null">name=#{name},</if>
            <if test="life!=null">life=#{life},</if>
            <if test="unit!=null">unit=#{unit},</if>
        </trim>
        where code=#{code}
    </update>

    <select id="getByCode" resultType="Map" parameterType="Map">
        select *  from eam_classification where code=#{code}
    </select>

    <select id="getByParentCode" resultType="Map" parameterType="Map">
        select *  from eam_classification where parent_code=#{parent_code}
    </select>

    <select id="getByPath" resultType="Map" parameterType="Map">
        select * from eam_classification where path like '${path}${code}-%'
    </select>


    <select id="getByKeyword" resultType="Map" parameterType="Map">
        select * from eam_classification ec
        where 1=1
        <if test="keyword != null and keyword!=''">  and (ec.code like '%${keyword}%' or ec.name like '%${keyword}%') </if>
    </select>


</mapper>
